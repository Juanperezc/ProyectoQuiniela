<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Crear quiniela</title>

  <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet">
  <link th:href="@{/font-awesome/css/font-awesome.css}" rel="stylesheet">

  <link th:href="@{/css/animate.css}" rel="stylesheet">
  <link th:href="@{/css/style.css}" rel="stylesheet">
  <link th:href="@{/css/plugins/steps/jquery.steps.css}" rel="stylesheet">

  <!-- separados -->

  <!-- FooTable -->
  <link th:href="@{/css/plugins/footable/footable.core.css}" rel="stylesheet">

  <!-- componentes personalizados -->
  <link th:href="@{/css/plugins/select2/select2.min.css}" rel="stylesheet">
  <link th:href="@{/css/plugins/awesome-bootstrap-checkbox/awesome-bootstrap-checkbox.css}" rel="stylesheet">
  <link th:href="@{/css/plugins/chosen/bootstrap-chosen.css}" rel="stylesheet">
  <link th:href="@{/css/plugins/touchspin/jquery.bootstrap-touchspin.min.css}" rel="stylesheet">
  <link th:href="@{/css/plugins/datetimepicker/bootstrap-datetimepicker.min.css}" rel="stylesheet">
</head>

<body class="skin-1 pace-done fixed-sidebar mini-navbar body-small">
  <div id="wrapper">
    <!-- menu sidebar -->
    <div th:replace="layouts/menu :: menu" />
    <!-- end menu sidebar -->
    <div id="page-wrapper" class="gray-bg">
      <div class="row border-bottom">
        <div th:replace="layouts/topbar :: topbar" />
      </div>
      <!-- content ! -->
      <div class="wrapper wrapper-content animated fadeInRight ecommerce">
        <div class="row">
          <div class="col-lg-12">
            <div class="panel panel-warning">
              <div class="panel-heading">
                <i class="fa fa-warning"></i> Alerta
              </div>
              <div class="panel-body">
                <p>Debe crear una liga antes de crear una quiniela.</p>
              </div>
            </div>
         
              <div class="panel panel-success">
                <div class="panel-heading">
                  <h1>Crear Quiniela</h1>
                </div>
                <div class="panel-body">
 
                  <div class="ibox">
                    
                    <div class="ibox-title">
                      <h2>
                        Crea una quiniela en pocos pasos
                      </h2>
                    </div>
                    <div class="ibox-content">
                  
                    <h3>DatosQuinielas</h3>
                    <fieldset class="form-horizontal">
                        <form
                      
                        autocomplete="off"
                        action="#"
                        th:action="${editroute}"
                        th:object="${quiniela}"
                        method="post"
                        class="form-horizontal"
                        role="form"
                        id="form">
                     <input th:disabled="${edit}" type="hidden" th:field="*{id}" ></input>
                        <div class="form-group">
                          <label class="col-sm-2 control-label">Nombre de la quiniela:</label>
                          <div class="col-sm-6">
                              <label
                              th:if="${#fields.hasErrors('name')}"
                              th:errors="*{name}"
                              class="validation-message"></label>
                            <input  type="text" th:field="*{name}" class="form-control required" placeholder="quiniela 1">
                          </div>
                        </div>
                        <div class="form-group">
                          <label class="col-sm-2 control-label ">Deporte:</label>
                          <div class="form-group">
                            <div class="col-sm-6">
                                <select th:disabled="${edit}"
                                th:field="*{sport}"
                                data-placeholder="Escoge un deporte..."
                                class="form-control m-b"
                                tabindex="-1">
                                <option th:each="sp : ${sports}" th:value="${sp.id}" th:selected="${sport != null and (sp.id == sport.id)}" th:text="${sp.name}"></option>
                            </select>
                              
                            </div>
                          </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label ">Tipo:</label>
                            <div class="form-group">
                              <div class="col-sm-6">
                                  <select th:disabled="${edit}" 
                                  th:field="*{type}"
                                  data-placeholder="Escoge un Tipo..."
                                  class="form-control m-b"
                                  tabindex="-1">
                                  <option  value="1" th:selected="${type != null and (type == 1)}" >Publica</option>
                                  <option  value="1" th:selected="${type != null and (type == 2)}" >Privada</option>
                              </select>
                                
                              </div>
                            </div>
                          </div>
                        <div class="form-group">
                          <label class="col-sm-2 control-label">Descripción
                          </label>
                          <div class="col-sm-6"> 
                              <label th:disabled="${edit}" 
                              th:if="${#fields.hasErrors('description')}"
                              th:errors="*{description}"
                              class="validation-message"></label>
                              <input type="text" th:field="*{description}"  class="form-control required" placeholder="ingrese la descripcion de la quiniela aquí">
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-md-1"></div>
                          <div class="col-md-4">
                              <div class="panel panel-success">
                                  <div class="panel-heading"> <h2>Fechas de la quiniela</h2></div>
                                  <div class="panel-body">
                            <div class="form-group">
                              <div class='input-group date' id='datetimepickerInicio'>
                                  <label
                                  th:if="${#fields.hasErrors('start')}"
                                  th:errors="*{start}"
                                  class="validation-message"></label>
                                <input type='text' th:field="*{start}" placeholder="Fecha de apertura" class="form-control" />
                                <span class="input-group-addon">
                                  <span class="glyphicon glyphicon-calendar"></span>
                                </span>
                              </div>
                            </div>
                            <div class="form-group">
                              <div class='input-group date' id='datetimepickerCierre'>
                                  <label
                                  th:if="${#fields.hasErrors('end')}"
                                  th:errors="*{end}"
                                  class="validation-message"></label>
                                <input type='text' th:field="*{end}" placeholder="Fecha de apertura" class="form-control" />
                                <span class="input-group-addon">
                                  <span class="glyphicon glyphicon-calendar"></span>
                                </span>
                              </div>
                            </div>
                          </div>
                          
                            </div>
                          </div>
                          <div class="col-md-1"></div>
                          
                          <div class="col-md-6">
                              <div class="panel panel-success">
                                <div class="panel-heading"> <h2> Reglas </h2></div>
                                  <div class="panel-body">
                            <div class="form-group">
                              <label class="col-sm-6 control-label">Puntuación para acierto del equipo ganador
                              </label>
                              <div class="col-sm-6">
                                <input class="touchspin" th:disabled="${edit}"  type="text" th:field="*{rule.teamScore}"  placeholder="0" readonly="readonly" style="background-color: white">
                              </div>
                            </div>
                            <div class="form-group">
                              <label class="col-sm-6 control-label">Puntuación para acierto de score exacto de un equipo
                              </label>
                              <div class="col-sm-6">
                                <input class="touchspin" th:disabled="${edit}"  type="text" th:field="*{rule.victorScore}"  placeholder="0" readonly="readonly" style="background-color: white">
                              </div>
                            </div>
                          </div>
                        </div>
                          </div>
                        </div>
                        <button type="submit" class="btn btn-block btn-primary" >Guardar</button>
                      </form>
                      </fieldset>
                    </div>
                  
 
                  </div>
                </div>
              </div>
              <div th:if="${edit}"  class="panel panel-info">
                <div class="panel-heading">
                  <h2>Datos de los Juegos</h2>
                </div>
                <div class="panel-body">
                  <div class="ibox">
                    <div class="ibox-title">
                      <div class="col-sm-6 col-sm-offset-5">
                        <label class="control-label">
                          <input type="button" class="btn btn-danger" data-toggle="modal" data-target="#modalNuevo" value="Agregar Juego">
                        </label>
                      </div>
                    </div>
                    <div class="ibox-content">
                      <fieldset class="form-horizontal">
                        <div class="row">
                          <div class="form-group">
                            <!-- Modales aqui -->
                            <div class="modal inmodal" id="modalNuevo" tabindex="-1" role="dialog" aria-hidden="true">
                              <div class="modal-dialog">
                                <div class="modal-content animated bounceInRight">
                                    <form
                                    autocomplete="off"
                                    action="#"
                                    th:action="@{${'/quiniela/create/game/'+ quiniela.id }}" 
                                    th:object="${game}"
                                    method="post"
                                    class="form-horizontal"
                                    role="form"
                                    id="form">
                                  <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal">
                                      <span aria-hidden="true">&times;</span>
                                      <span class="sr-only">Close</span>
                                    </button>
                                    <i class="fa fa-futbol-o modal-icon"></i>
                                    <h4 class="modal-title">Nuevo juego</h4>
                                    <small class="font-bold">Por favor introduzca todos los campos para agregar el juego a la quiniela</small>
                                  </div>
                                  <div class="modal-body">

                                    <div class="form-group">
                                      <label class="col-sm-2 control-label">Ligas:</label>
                                      <div class="col-sm-10">
                                          <select id="select-liga"
                                          data-placeholder="Escoge una liga..."
                                          class="form-control m-b"
                                          tabindex="-1">
                                          <option th:each="liga : ${ligas}" th:value="${liga.id}" th:text="${liga.name}"></option>
                                          </select>
                                      </div>
                                    </div>
                                    <div class="form-group">
                                      <label class="col-sm-2 control-label">Equipo 1:</label>
                                      <div class="col-sm-10">
                                          <select id="select-eq1"
                                          data-placeholder="Escoge un equipo..."
                                          th:field="*{team1}"
                                          class="form-control m-b"
                                          tabindex="-1">
                                          </select>
                                      </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">Equipo 2:</label>
                                        <div class="col-sm-10">
                                            <select id="select-eq2"
                                            data-placeholder="Escoge un equipo..."
                                            th:field="*{team2}"
                                            class="form-control m-b"
                                            tabindex="-1">
                                            </select>
                                        </div>
                                      </div>
                             
                                    <div class="form-group">
                                      <label class="col-sm-2 control-label">Descripción:</label>
                                      <div class="col-sm-10">
                                        <input type="text" th:field="*{description}" class="form-control" placeholder="">
                                      </div>
                                    </div>
                                    <div class="form-group">
                                        <label
                                  th:if="${#fields.hasErrors('date')}"
                                  th:errors="*{date}"
                                  class="validation-message"></label>
                                      <label class="col-sm-2 control-label">Fecha  </label>
                                      <div class="col-sm-5">
                                        <div class="form-group">
                                          <div class='input-group date' id='datetimepickerModal'>
                                            <input th:field="*{date}" type='text' class="form-control" />
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-calendar"></span>
                                            </span>
                                        </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="modal-footer">
                                    <button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
                                    <button type="submit" class="btn btn-primary">Agregar juego</button>
                                  </div>
                                </form>
                                </div>
                              </div>
                            </div>
                            
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-lg-12">
                            <div class="ibox">
                              <div class="ibox-content">
                                <input type="text" class="form-control input-sm m-b-xs" id="filter" placeholder="Buscar..">
                                <table class="footable table table-stripped toggle-arrow-tiny" data-page-size="15" data-filter=#filter>
                                  <thead>
                                    <tr>
                                      <th data-toggle="true">Id</th>
                                      <th data-hide="phone">Equipo 1</th>
                                      <th data-hide="all">Puntuación E1</th>
                                      <th data-hide="phone">Equipo 2</th>
                                      <th data-hide="phone,tablet">Puntuación E2</th>
                                      <th data-hide="phone">Status</th>
                                      <th class="text-center" data-sort-ignore="true">Acción</th>
                                    </tr>
                                  </thead>
                                  <tbody th:each="game : ${quiniela.games}">
                                    <tr>
                                      <td th:text="${game.id}"></td>
                                      <td th:text="${game.team1}"></td>
                                      <td>0</td>
                                      <td th:text="${game.team2}"></td>
                                      <td>0</td>
                                      <td>
                                        <span class="label label-success">Por Disputar</span>
                                      </td>
                                      <td class="text-right">
                                        <div class="btn-group">
                                         
                                          <button class="btn btn-warning" data-toggle="modal" data-target="#modalEditar">Editar</button>
                     
                                        </div>
                                      </td>
                                    </tr>
                                
                                  </tbody>
                                  <tfoot>
                                    <tr>
                                      <td colspan="2">
                                        <ul class="pagination pull-right"></ul>
                                      </td>
                                    </tr>
                                  </tfoot>
                                </table>
                              </div>
                            </div>
                          </div>
                        </div>
                      </fieldset>
                    </div>
                  </div>

                </div>



            </div>
          </div>
          <div class="col-lg-12" th:replace="layouts/footer :: footer" />
          <!-- Mainly scripts -->
          <script th:src="@{/js/jquery-3.1.1.min.js}"></script>
          <script th:src="@{/js/bootstrap.min.js}"></script>
          <script th:src="@{/js/bootstrap-confirmation.js}"></script>
          <script th:src="@{/js/plugins/metisMenu/jquery.metisMenu.js}"></script>
          <script th:src="@{/js/plugins/slimscroll/jquery.slimscroll.min.js}"></script>

          <!-- Select2 -->
          <script th:src="@{/js/plugins/select2/select2.full.min.js}"></script>

          <!-- Chosen -->
          <script th:src="@{/js/plugins/chosen/chosen.jquery.js}"></script>

          <!-- FooTable -->
          <script th:src="@{/js/plugins/footable/footable.all.min.js}"></script>

          <!-- Custom and plugin javascript -->
          <script th:src="@{/js/inspinia.js}"></script>
          <script th:src="@{/js/plugins/pace/pace.min.js}"></script>
          <!-- Date picker -->
          <script th:src="@{/js/plugins/datapicker/bootstrap-datepicker.js}"></script>
          <script th:src="@{/js/plugins/fullcalendar/moment.min.js}"></script>
          <script th:src="@{/js/plugins/daterangepicker/daterangepicker.js}"></script>
          <!-- TouchSpin -->
          <script th:src="@{/js/plugins/touchspin/jquery.bootstrap-touchspin.min.js}"></script>

          <!-- Steps -->
          <script th:src="@{/js/plugins/steps/jquery.steps.min.js}"></script>
          <!-- Jquery Validate -->
          <script th:src="@{/js/plugins/validate/jquery.validate.min.js}"></script>
          <!-- Jquery Validate -->
          <script th:src="@{/js/plugins/datetimepicker/bootstrap-datetimepicker.min.js}"></script>

          <!-- Page-Level Scripts -->

          <script>
            $(document).ready(function () {
              $('.chosen-select').chosen({
                width: "100%"
              });
              $(".touchspin").TouchSpin({
                min: 1,
                max: 10,
                step: 1,
                decimals: 0,
                boostat: 5,
                maxboostedstep: 10,
                buttondown_class: 'btn btn-white',
                buttonup_class: 'btn btn-white'
              });
              $('#datetimepickerModal').datetimepicker({
                format: 'YYYY-MM-DD hh:mm'
              });
              $('#datetimepickerInicio').datetimepicker({
                format: 'YYYY-MM-DD hh:mm'
              }
              );
              $('#datetimepickerCierre').datetimepicker({
              //  useCurrent: false, //Important! See issue #1075
                format: 'YYYY-MM-DD hh:mm'
              });
              $("#datetimepickerInicio").on("dp.change", function (e) {
                $('#datetimepickerCierre').data("DateTimePicker").minDate(e.date);
              });
              $("#datetimepickerCierre").on("dp.change", function (e) {
                $('#datetimepickerInicio').data("DateTimePicker").maxDate(e.date);
              });
              $('.footable').footable();
              $('.footable2').footable();

              $('[data-toggle=confirmation]').confirmation({
                rootSelector: '[data-toggle=confirmation]',
                // other options
              });

        
        // event called when the country select is changed
        $("#select-liga").change(function(){
            // get the currently selected country ID
            var ligaId = $(this).val();
            console.log(ligaId);
            $.ajax({
                // make the ajax call to our server and pass the country ID as a GET variable
                url: "/api/team/liga/" + ligaId,
            }).done(function(data) {
                // our ajax call is finished, we have the data returned from the server in a var called data
                //data = JSON.parse(data);
                console.log(data);
                $('#select-eq1').html("");
                $('#select-eq2').html("");
                // loop through our returned data and add an option to the select for each province returned
                $.each(data, function(i, item) {
                    $('#select-eq1').append($('<option>', {value:item.name, text:item.name}));
                        $('#select-eq2').append($('<option>', {value:item.name, text:item.name}));
                });
                

               });
             });
  
            });

          </script>

</body>

</html>
